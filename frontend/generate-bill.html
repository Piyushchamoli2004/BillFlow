<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Generate Bill - BillFlow</title>
    <link rel="stylesheet" href="dashboard-styles.css">
    <link rel="stylesheet" href="generate-bill-styles.css">
    <link rel="stylesheet" href="notification-system.css">
    <!-- api-connector.js included at the bottom, before generate-bill-script.js -->
</head>
<body>
    <!-- Top Navigation Bar -->
    <nav class="top-navbar">
        <div class="nav-left">
            <button class="menu-toggle" onclick="toggleSidebar()" aria-label="Toggle Menu">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="3" y1="12" x2="21" y2="12"/>
                    <line x1="3" y1="6" x2="21" y2="6"/>
                    <line x1="3" y1="18" x2="21" y2="18"/>
                </svg>
            </button>
            <div class="logo">
                <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
                    <rect width="36" height="36" rx="10" fill="url(#logoGradient)"/>
                    <path d="M11 13h14M11 18h14M11 23h10" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
                    <defs>
                        <linearGradient id="logoGradient" x1="0" y1="0" x2="36" y2="36">
                            <stop offset="0%" style="stop-color:#667eea"/>
                            <stop offset="100%" style="stop-color:#764ba2"/>
                        </linearGradient>
                    </defs>
                </svg>
                <span class="logo-text">BillFlow</span>
            </div>
        </div>
        
        <div class="nav-right">
            <div class="user-profile-container">
                <div class="user-profile" onclick="toggleUserDropdown()">
                    <div class="user-avatar">
                        <img src="data:image/svg+xml,%3Csvg width='40' height='40' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23667eea'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' fill='white' font-family='Arial' font-size='16' font-weight='bold'%3EA%3C/text%3E%3C/svg%3E" alt="Admin">
                    </div>
                    <div class="user-info">
                        <div class="user-name">Admin User</div>
                        <div class="user-role">Administrator</div>
                    </div>
                    <svg class="dropdown-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="user-dropdown" id="userDropdown">
                    <div class="dropdown-header">
                        <div class="dropdown-header-name">Admin User</div>
                        <div class="dropdown-header-email">admin@billflow.com</div>
                    </div>
                    <div class="dropdown-menu">
                        <a href="settings.html#profile" class="dropdown-item">
                            <svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="6" r="3" stroke="currentColor" stroke-width="1.5"/><path d="M4 16C4 13 6.5 11 10 11C13.5 11 16 13 16 16" stroke="currentColor" stroke-width="1.5"/></svg>
                            <span>My Profile</span>
                        </a>
                        <a href="settings.html#company" class="dropdown-item">
                            <svg viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="3" stroke="currentColor" stroke-width="1.5"/><path d="M10 2V4M10 16V18M18 10H16M4 10H2M15.5 4.5L14 6M6 14L4.5 15.5M15.5 15.5L14 14M6 6L4.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                            <span>Company Settings</span>
                        </a>
                        <a href="admin-dashboard.html" class="dropdown-item">
                            <svg viewBox="0 0 20 20" fill="none"><rect x="2" y="2" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/><rect x="11" y="2" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/><rect x="2" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/><rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/></svg>
                            <span>Dashboard</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item danger" onclick="handleLogout(event)">
                            <svg viewBox="0 0 20 20" fill="none"><path d="M13 6L18 10L13 14M18 10H8M8 2H5C3.89543 2 3 2.89543 3 4V16C3 17.1046 3.89543 18 5 18H8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="admin-dashboard.html" class="nav-item">
                    <svg class="nav-icon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <rect x="3" y="3" width="7" height="7" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="3" y="12" width="7" height="7" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="12" y="3" width="7" height="7" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="12" y="12" width="7" height="7" rx="2" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span class="nav-text">Dashboard</span>
                </a>
                
                <a href="generate-bill.html" class="nav-item active">
                    <svg class="nav-icon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <path d="M7 3L5 5V19L7 21H15L17 19V5L15 3H7Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M8 8H14M8 11H14M8 14H11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span class="nav-text">Generate Bill</span>
                </a>
                
                <a href="payment-history.html" class="nav-item">
                    <svg class="nav-icon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <rect x="3" y="6" width="16" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M7 6V5C7 3.89543 7.89543 3 9 3H13C14.1046 3 15 3.89543 15 5V6" stroke="currentColor" stroke-width="1.5"/>
                        <circle cx="11" cy="12" r="2" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span class="nav-text">Payment History</span>
                </a>
                
                <a href="tenant-details.html" class="nav-item">
                    <svg class="nav-icon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <circle cx="11" cy="7" r="3" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M6 19C6 16 8 14 11 14C14 14 16 16 16 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span class="nav-text">Tenant Details</span>
                </a>
                
                <a href="settings.html" class="nav-item">
                    <svg class="nav-icon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <circle cx="11" cy="11" r="3" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M11 3V5M11 17V19M19 11H17M5 11H3M16.5 5.5L15 7M7 15L5.5 16.5M16.5 16.5L15 15M7 7L5.5 5.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span class="nav-text">Settings</span>
                </a>
                
                <div class="sidebar-divider"></div>
                
                <a href="login.html" class="nav-item nav-item-logout">
                    <svg class="nav-icon" width="22" height="22" viewBox="0 0 22 22" fill="none">
                        <path d="M9 19H5C3.89543 19 3 18.1046 3 17V5C3 3.89543 3.89543 3 5 3H9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M15 15L19 11L15 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19 11H9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span class="nav-text">Logout</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <div class="breadcrumb">
                    <a href="admin-dashboard.html" class="breadcrumb-link">Dashboard</a>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="breadcrumb-current">Generate Bill</span>
                </div>
                <h1 class="page-title">Generate Bill</h1>
                <p class="page-subtitle">Create new bills for tenants with automated calculations</p>
            </div>

            <!-- Generate Bill Form Card -->
            <div class="form-card">
                <form class="bill-form">
                    <!-- Basic Information Section -->
                    <div class="form-section">
                        <h2 class="section-title">Basic Information</h2>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">
                                    <svg class="label-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <circle cx="8" cy="5" r="2.5" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M4 13C4 11 6 9 8 9C10 9 12 11 12 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    Select Tenant
                                    <button type="button" onclick="loadTenants()" style="margin-left: 10px; background: #667eea; color: white; border: none; padding: 4px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                                        ðŸ”„ Refresh
                                    </button>
                                </label>
                                <div class="select-wrapper">
                                    <select class="form-select" id="tenantSelect">
                                        <option value="">Choose a tenant...</option>
                                    </select>
                                    <svg class="select-arrow" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <svg class="label-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <rect x="3" y="3" width="10" height="10" rx="2" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M3 6H13M6 1V3M10 1V3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    Bill Date
                                </label>
                                <input type="date" class="form-input" value="2025-12-08">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">
                                    <svg class="label-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M8 5V9M6 7C6 6.5 6.5 6 7 6H9C9.5 6 10 6.5 10 7C10 7.5 9.5 8 9 8H7C6.5 8 6 8.5 6 9C6 9.5 6.5 10 7 10H9C9.5 10 10 9.5 10 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    Base Amount (â‚¹)
                                </label>
                                <input type="number" class="form-input" placeholder="Enter base amount (e.g., 5000)" value="">
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <svg class="label-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <path d="M5 3L3 5V13L5 15H11L13 13V5L11 3H5Z" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M6 7H10M6 9H10M6 11H8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    Bill Number
                                </label>
                                <input type="text" class="form-input" placeholder="Auto-generated" value="BILL-2025-0247" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Electricity Calculation Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <svg class="section-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M11 2L6 10H10L9 18L14 10H10L11 2Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                </svg>
                                Electricity
                            </h2>
                            <span class="section-formula">Current â€“ Previous Ã— Rate</span>
                        </div>

                        <div class="calculation-grid">
                            <div class="calc-group">
                                <label class="calc-label">Current Reading</label>
                                <div class="input-with-unit">
                                    <input type="number" class="calc-input" placeholder="0" value="50">
                                    <span class="input-unit">kWh</span>
                                </div>
                            </div>

                            <div class="calc-operator">âˆ’</div>

                            <div class="calc-group">
                                <label class="calc-label">Previous Reading</label>
                                <div class="input-with-unit">
                                    <input type="number" class="calc-input" placeholder="0" value="30">
                                    <span class="input-unit">kWh</span>
                                </div>
                            </div>

                            <div class="calc-operator">Ã—</div>

                            <div class="calc-group">
                                <label class="calc-label">Rate per Unit</label>
                                <div class="input-with-unit">
                                    <span class="input-currency">â‚¹</span>
                                    <input type="number" class="calc-input" placeholder="0.00" value="0.25" step="0.01">
                                </div>
                            </div>

                            <div class="calc-operator">=</div>

                            <div class="calc-group calc-result">
                                <label class="calc-label">Amount</label>
                                <div class="result-display">
                                    <span class="result-currency">â‚¹</span>
                                    <span class="result-value">5.00</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Water Calculation Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <svg class="section-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M10 2C10 2 6 6 6 10C6 12.2091 7.79086 14 10 14C12.2091 14 14 12.2091 14 10C14 6 10 2 10 2Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                    <path d="M7 18H13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Water
                            </h2>
                            <span class="section-formula">Current â€“ Previous Ã— Rate</span>
                        </div>

                        <div class="calculation-grid">
                            <div class="calc-group">
                                <label class="calc-label">Current Reading</label>
                                <div class="input-with-unit">
                                    <input type="number" class="calc-input" placeholder="0" value="10">
                                    <span class="input-unit">mÂ³</span>
                                </div>
                            </div>

                            <div class="calc-operator">âˆ’</div>

                            <div class="calc-group">
                                <label class="calc-label">Previous Reading</label>
                                <div class="input-with-unit">
                                    <input type="number" class="calc-input" placeholder="0" value="5">
                                    <span class="input-unit">mÂ³</span>
                                </div>
                            </div>

                            <div class="calc-operator">Ã—</div>

                            <div class="calc-group">
                                <label class="calc-label">Rate per Unit</label>
                                <div class="input-with-unit">
                                    <span class="input-currency">â‚¹</span>
                                    <input type="number" class="calc-input" placeholder="0.00" value="2.00" step="0.01">
                                </div>
                            </div>

                            <div class="calc-operator">=</div>

                            <div class="calc-group calc-result">
                                <label class="calc-label">Amount</label>
                                <div class="result-display">
                                    <span class="result-currency">â‚¹</span>
                                    <span class="result-value">10.00</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Other Charges Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <svg class="section-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M4 6H16M4 10H16M4 14H12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Other Charges
                            </h2>
                            <span class="section-subtitle">Optional additional charges</span>
                        </div>

                        <div class="charges-grid">
                            <div class="charge-item">
                                <label class="charge-label">
                                    <svg class="charge-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <path d="M8 1V3M8 13V15M1 8H3M13 8H15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                        <rect x="4" y="4" width="8" height="8" rx="2" stroke="currentColor" stroke-width="1.5"/>
                                    </svg>
                                    Maintenance Charge
                                </label>
                                <div class="input-with-unit">
                                    <span class="input-currency">â‚¹</span>
                                    <input type="number" class="charge-input" placeholder="0.00" step="0.01">
                                </div>
                            </div>

                            <div class="charge-item">
                                <label class="charge-label">
                                    <svg class="charge-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <path d="M3 5L8 2L13 5V11L8 14L3 11V5Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                    </svg>
                                    Garbage Fee
                                </label>
                                <div class="input-with-unit">
                                    <span class="input-currency">â‚¹</span>
                                    <input type="number" class="charge-input" placeholder="0.00" step="0.01">
                                </div>
                            </div>

                            <div class="charge-item">
                                <label class="charge-label">
                                    <svg class="charge-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <rect x="2" y="6" width="12" height="7" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M5 6V4C5 3.44772 5.44772 3 6 3H10C10.5523 3 11 3.44772 11 4V6" stroke="currentColor" stroke-width="1.5"/>
                                    </svg>
                                    Parking
                                </label>
                                <div class="input-with-unit">
                                    <span class="input-currency">â‚¹</span>
                                    <input type="number" class="charge-input" placeholder="0.00" step="0.01">
                                </div>
                            </div>

                            <div class="charge-item">
                                <label class="charge-label">
                                    <svg class="charge-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                                        <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                        <path d="M8 5V8L10 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    </svg>
                                    Custom Field
                                </label>
                                <div class="input-with-unit">
                                    <span class="input-currency">â‚¹</span>
                                    <input type="number" class="charge-input" placeholder="0.00" step="0.01">
                                </div>
                            </div>
                        </div>

                        <button type="button" class="btn-add-more">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M9 4V14M4 9H14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Add More Charges
                        </button>
                    </div>

                    <!-- Total Summary -->
                    <div class="summary-section">
                        <div class="summary-row">
                            <span class="summary-label">Subtotal</span>
                            <span class="summary-value">â‚¹15.00</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Tax (0%)</span>
                            <span class="summary-value">â‚¹0.00</span>
                        </div>
                        <div class="summary-divider"></div>
                        <div class="summary-row summary-total">
                            <span class="summary-label">Total Amount</span>
                            <span class="summary-value">â‚¹15.00</span>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M15 10H5M5 10L9 6M5 10L9 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Cancel
                        </button>
                        <button type="button" class="btn btn-outline">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M10 3C10 3 6 7 6 11C6 13.2091 7.79086 15 10 15C12.2091 15 14 13.2091 14 11C14 7 10 3 10 3Z" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                            Save as Draft
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M6 3L4 5V17L6 19H14L16 17V5L14 3H6Z" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M7 8H13M7 11H13M7 14H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Generate Bill
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>
    
    <script src="notification-system.js"></script>
    <script src="navbar-dropdown.js"></script>
    <script src="api-connector.js"></script>
    <script src="generate-bill-script.js"></script>
</body>
</html>
